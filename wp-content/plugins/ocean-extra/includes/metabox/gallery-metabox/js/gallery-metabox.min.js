jQuery(function(a){function c(){a("#gallery-metabox-list li").each(function(b){a(this).find("input:hidden").attr("name","ocean_gallery_id["+b+"]")})}function d(){a("#gallery-metabox-list").sortable({opacity:.6,stop:function(){c()}})}var b;a(document).on("click","#oceanwp-gallery-metabox a.gallery-add",function(c){c.preventDefault(),b&&b.close(),b=wp.media.frames.file_frame=wp.media({title:a(this).data("uploader-title"),button:{text:a(this).data("uploader-button-text")},multiple:!0}),b.on("select",function(){var c=a("#gallery-metabox-list li").index(a("#gallery-metabox-list li:last")),d=b.state().get("selection");d.map(function(b,d){b=b.toJSON(),index=c+(d+1),a("#gallery-metabox-list").append('<li class="image"><div class="attachment-preview"><input type="hidden" name="ocean_gallery_id['+index+']" value="'+b.id+'"><div class="thumb"><img class="image-preview" src="'+b.sizes.thumbnail.url+'"></div><a class="change-image button" href="#">Change image</a><a class="remove-image" href="#" title="Remove image"><i class="dashicons dashicons-no-alt"></i></a></div></li>')})}),d(),b.open()}),a(document).on("click","#oceanwp-gallery-metabox a.change-image",function(c){c.preventDefault();var d=a(this);b&&b.close(),b=wp.media.frames.file_frame=wp.media({title:a(this).data("uploader-title"),button:{text:a(this).data("uploader-button-text")},multiple:!1}),b.on("select",function(){attachment=b.state().get("selection").first().toJSON(),d.parent().find("input:hidden").attr("value",attachment.id),d.parent().find("img.image-preview").attr("src",attachment.sizes.thumbnail.url)}),b.open()}),a(document).on("click","#oceanwp-gallery-metabox a.remove-image",function(b){b.preventDefault(),a(this).parents("li").animate({opacity:0},200,function(){a(this).remove(),c()})}),d()});