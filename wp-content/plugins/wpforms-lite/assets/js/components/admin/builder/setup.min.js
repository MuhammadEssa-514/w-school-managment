"use strict";var WPForms=window.WPForms||{};WPForms.Admin=WPForms.Admin||{},WPForms.Admin.Builder=WPForms.Admin.Builder||{},WPForms.Admin.Builder.Setup=WPForms.Admin.Builder.Setup||function(a,o){var s={},r={};const n=o(".wpforms-template.selected .wpforms-template-name").text().trim();var l={init:function(){o(l.ready),o(a).on("load",function(){"function"==typeof o.ready.then?o.ready.then(l.load):l.load()})},ready:function(){l.setup(),l.setPanelsToggleState(),l.setupTitleFocus(),l.setTriggerBlankLink(),l.events(),s.$builder.trigger("wpformsBuilderSetupReady")},load:function(){l.applyTemplateOnRequest()},setup:function(){s={$builder:o("#wpforms-builder"),$form:o("#wpforms-builder-form"),$formName:o("#wpforms-setup-name"),$panel:o("#wpforms-panel-setup"),$categories:o("#wpforms-panel-setup .wpforms-setup-templates-categories")},r.templateList=new List("wpforms-setup-templates-list",{valueNames:["wpforms-template-name","wpforms-template-desc",{name:"categories",attr:"data-categories"}]}),r.spinner='<i class="wpforms-loading-spinner wpforms-loading-white wpforms-loading-inline"></i>',r.formID=s.$form.data("id")},events:function(){s.$panel.on("keyup","#wpforms-setup-template-search",WPFormsFormTemplates.searchTemplate).on("click",".wpforms-setup-templates-categories li",WPFormsFormTemplates.selectCategory).on("click",".wpforms-template-select",l.selectTemplate).on("click",".wpforms-trigger-blank",l.selectBlankTemplate),s.$builder.on("wpformsPanelSwitched",l.setupTitleFocus),s.$builder.on("input","#wpforms-panel-field-settings-form_title",l.syncTitle).on("input","#wpforms-setup-name",l.syncTitle)},setPanelsToggleState:function(){s.$builder.find("#wpforms-panels-toggle button:not(.active)").toggleClass("wpforms-disabled",""===r.formID)},setTriggerBlankLink:function(){s.$builder.find(".wpforms-trigger-blank").attr({"data-template-name-raw":"Blank Form","data-template":"blank"})},setupTitleFocus:function(e,t){"setup"===(t=void 0===t?wpf.getQueryString("view"):t)&&s.$formName.trigger("focus")},syncTitle:function(e){("wpforms-setup-name"===e.target.id?o("#wpforms-panel-field-settings-form_title"):o("#wpforms-setup-name")).val(e.target.value)},searchTemplate:function(e){console.warn('WARNING! Function "WPForms.Admin.Builder.Setup.searchTemplate( e )" has been deprecated, please use the new "WPFormsFormTemplates.searchTemplate( e )" function instead!'),WPFormsFormTemplates.searchTemplate(e)},selectCategory:function(e){console.warn('WARNING! Function "WPForms.Admin.Builder.Setup.selectCategory( e )" has been deprecated, please use the new "WPFormsFormTemplates.selectCategory( e )" function instead!'),WPFormsFormTemplates.selectCategory(e)},selectTemplate:function(e){e.preventDefault();var e=o(this),t=e.data("template"),a=l.getFormName(e);e.hasClass("education-modal")||(s.$panel.find(".wpforms-template").removeClass("active"),e.closest(".wpforms-template").addClass("active"),e.data("labelOriginal",e.html()),e.html(r.spinner+wpforms_builder.loading),l.applyTemplate(a,t,e))},getFormName:function(e){var e=e.data("template-name-raw"),t=s.$formName.val();return!t||n===t?e:t},applyTemplate:function(e,t,a){s.$builder.trigger("wpformsTemplateSelect",t),r.formID?l.selectTemplateExistingForm(e,t,a):WPFormsFormTemplates.selectTemplateProcess(e,t,a,l.selectTemplateProcessAjax)},selectBlankTemplate:function(e){e.preventDefault();var e=o(e.target),t=s.$formName.val()||wpforms_builder.blank_form;l.applyTemplate(t,"blank",e)},selectTemplateExistingForm:function(e,t,a){o.confirm({title:wpforms_builder.heads_up,content:wpforms_builder.template_confirm,icon:"fa fa-exclamation-circle",type:"orange",buttons:{confirm:{text:wpforms_builder.ok,btnClass:"btn-confirm",keys:["enter"],action:function(){WPFormsFormTemplates.selectTemplateProcess(e,t,a,l.selectTemplateProcessAjax)}},cancel:{text:wpforms_builder.cancel,action:function(){WPFormsFormTemplates.selectTemplateCancel()}}}})},selectTemplateProcess:function(e,t,a){console.warn('WARNING! Function "WPForms.Admin.Builder.Setup.selectTemplateProcess( formName, template, $button )" has been deprecated, please use the new "WPFormsFormTemplates.selectTemplateProcess( formName, template, $button, callback )" function instead!'),WPFormsFormTemplates.selectTemplateProcess(e,t,a,l.selectTemplateProcessAjax)},selectTemplateCancel:function(){console.warn('WARNING! Function "WPForms.Admin.Builder.Setup.selectTemplateCancel" has been deprecated, please use the new "WPFormsFormTemplates.selectTemplateCancel" function instead!'),WPFormsFormTemplates.selectTemplateCancel()},selectTemplateProcessAjax:function(t,e){WPFormsBuilder.showLoadingOverlay();e={title:t,action:r.formID?"wpforms_update_form_template":"wpforms_new_form",template:e,form_id:r.formID,nonce:wpforms_builder.nonce};o.post(wpforms_builder.ajax_url,e).done(function(e){e.success?(WPFormsBuilder.setCloseConfirmation(!1),a.location.href=wpf.getQueryString("force_desktop_view")?wpf.updateQueryString("force_desktop_view",1,e.data.redirect):e.data.redirect):(wpf.debug(e),"invalid_template"===e.data.error_type?l.selectTemplateProcessInvalidTemplateError(e.data.message,t):l.selectTemplateProcessError(e.data.message))}).fail(function(e,t,a){wpf.debug(e.responseText||t||""),l.selectTemplateProcessError("")})},selectTemplateProcessInvalidTemplateError:function(e,t){o.alert({title:wpforms_builder.heads_up,content:e,icon:"fa fa-exclamation-circle",type:"orange",boxWidth:"600px",buttons:{confirm:{text:wpforms_builder.use_simple_contact_form,btnClass:"btn-confirm",keys:["enter"],action:function(){l.selectTemplateProcessAjax(t,"simple-contact-form-template"),WPFormsBuilder.hideLoadingOverlay()}},cancel:{text:wpforms_builder.cancel,action:function(){WPFormsFormTemplates.selectTemplateCancel(),WPFormsBuilder.hideLoadingOverlay()}}}})},selectTemplateProcessError:function(e){e=e&&e.length?"<p>"+e+"</p>":"";o.alert({title:wpforms_builder.heads_up,content:wpforms_builder.error_select_template+e,icon:"fa fa-exclamation-circle",type:"orange",buttons:{confirm:{text:wpforms_builder.ok,btnClass:"btn-confirm",keys:["enter"],action:function(){WPFormsFormTemplates.selectTemplateCancel(),WPFormsBuilder.hideLoadingOverlay()}}}})},addonsModal:function(e,t,a){console.warn('WARNING! Function "WPForms.Admin.Builder.Setup.addonsModal( formName, template, $button )" has been deprecated, please use the new "WPFormsFormTemplates.addonsModal( formName, template, $button, callback )" function instead!'),WPFormsFormTemplates.addonsModal(e,t,a,l.selectTemplateProcessAjax)},installActivateAddons:function(e,t,a,o){console.warn('WARNING! Function "WPForms.Admin.Builder.Setup.installActivateAddons( addons, previousModal, formName, template )" has been deprecated, please use the new "WPFormsFormTemplates.installActivateAddons( addons, previousModal, formName, template, callback )" function instead!'),WPFormsFormTemplates.installActivateAddons(e,t,a,o,l.selectTemplateProcessAjax)},installActivateAddonsError:function(e,t){console.warn('WARNING! Function "WPForms.Admin.Builder.Setup.installActivateAddonsError( formName, template )" has been deprecated, please use the new "WPFormsFormTemplates.installActivateAddonsError( formName, template, callback )" function instead!'),WPFormsFormTemplates.installActivateAddonsError(e,t,l.selectTemplateProcessAjax)},installActivateAddonAjax:function(e){return console.warn('WARNING! Function "WPForms.Admin.Builder.Setup.installActivateAddonAjax( addon )" has been deprecated, please use the new "WPFormsFormTemplates.installActivateAddonAjax( addon )" function instead!'),WPFormsFormTemplates.installActivateAddonAjax(e)},applyTemplateOnRequest:function(){var e=new URLSearchParams(a.location.search),t=e.get("template_id");"setup"===e.get("view")&&!e.get("form_id")&&t&&s.$panel.find('.wpforms-template .wpforms-btn[data-template="'+t+'"]').trigger("click")}};return l}((document,window),jQuery),WPForms.Admin.Builder.Setup.init();