"use strict";var WPForms=window.WPForms||{};WPForms.Admin=WPForms.Admin||{},WPForms.Admin.Builder=WPForms.Admin.Builder||{},WPForms.Admin.Builder.Settings=WPForms.Admin.Builder.Settings||function(t,i){var n={},o={},a={init:function(){i(a.ready)},ready:function(){a.setup(),a.initTags(),a.events()},setup:function(){n={$builder:i("#wpforms-builder"),$panel:i("#wpforms-panel-settings"),$selectTags:i("#wpforms-panel-field-settings-form_tags")}},events:function(){n.$panel.on("keydown","#wpforms-panel-field-settings-form_tags-wrap input",a.addCustomTagInput).on("removeItem","#wpforms-panel-field-settings-form_tags-wrap select",a.editTagsRemoveItem),n.$selectTags.on("change",a.changeTags)},initTags:function(){var e;n.$selectTags.length&&"function"==typeof t.Choices&&(o.tagsChoicesObj=new Choices(n.$selectTags[0],wpforms_builder_settings.choicesjs_config),e=o.tagsChoicesObj.getValue(!0),o.tagsChoicesObj.clearStore().setChoices(wpforms_builder_settings.all_tags_choices,"value","label",!0).setChoiceByValue(e),n.$selectTags.data("choicesjs",o.tagsChoicesObj),a.initTagsHiddenInput())},initTagsHiddenInput:function(){n.$selectTagsHiddenInput=i('<input type="hidden" name="settings[form_tags_json]">'),n.$selectTags.closest(".wpforms-panel-field").append(n.$selectTagsHiddenInput),a.changeTags(null),!0===wpf.initialSave&&(wpf.savedState=wpf.getFormState("#wpforms-builder-form"))},addCustomTagInput:function(e){var t,s;["Enter",","].indexOf(e.key)<0||(e.preventDefault(),e.stopPropagation(),o.tagsChoicesObj&&0!==e.target.value.length&&(t=_.escape(e.target.value).trim(),s=_.map(o.tagsChoicesObj.getValue(),"label").map(function(e){return e.toLowerCase().trim()}),""===t||0<=s.indexOf(t.toLowerCase())?o.tagsChoicesObj.clearInput():(a.addCustomTagInputCreate(t),a.changeTags(e))))},editTagsRemoveItem:function(t){var e,s,a;0<=_.map(wpforms_builder_settings.all_tags_choices,"value").indexOf(t.detail.value)||(s=(e=i(t.target).data("choicesjs")).getValue(!0),a=_.filter(e._currentState.choices,function(e){return e.value!==t.detail.value}),e.clearStore().setChoices(a,"value","label",!0).setChoiceByValue(s))},addCustomTagInputCreate:function(e){var t=_.find(wpforms_builder_settings.all_tags_choices,{label:e});t&&t.value?o.tagsChoicesObj.setChoiceByValue(t.value):o.tagsChoicesObj.setChoices([{value:e,label:e,selected:!0}],"value","label",!1),o.tagsChoicesObj.clearInput()},changeTags:function(e){for(var t=o.tagsChoicesObj.getValue(),s=[],a=0;a<t.length;a++)s.push({value:t[a].value,label:t[a].label});n.$selectTagsHiddenInput.val(JSON.stringify(s))}};return a}((document,window),jQuery),WPForms.Admin.Builder.Settings.init();